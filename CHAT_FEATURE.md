# LLM对话功能使用说明

## 功能概述
我们已经成功为Article Translator浏览器插件添加了基础的LLM对话功能。

## 新增功能

### 1. 对话标签页
- 在原文和译文标签页后面新增了"对话"标签
- 提供简单的聊天界面，支持与LLM进行对话

### 2. 聊天界面
- **消息显示区域**: 显示用户和AI的对话历史
  - 用户消息：蓝色背景，右对齐
  - AI消息：灰色背景，左对齐
- **输入区域**: 
  - 多行文本输入框
  - 发送按钮
  - 支持Enter键发送（Shift+Enter换行）

### 3. 设置配置
- 在设置面板中新增"Chat Settings"部分
- 可配置聊天系统提示词（默认："你是一位有用的AI助手"）

## 技术实现

### 复用现有架构
- 使用现有的Settings类管理配置
- 复用现有的API配置（base_url、api_key、model等）
- 保持与现有错误处理机制的一致性

### 新增文件修改
1. **settings.js**: 添加chat_system_prompt配置项
2. **sidebar.html**: 添加对话标签页和聊天界面HTML
3. **sidebar.js**: 实现聊天功能的JavaScript代码

### 核心功能函数
- `displayChatMessage()`: 显示消息
- `sendChatMessage()`: 发送用户消息
- `callChatAPI()`: 调用LLM API
- `updateChatSendButton()`: 更新发送按钮状态

## 使用方法

1. **配置API**: 在设置中配置LLM后端（base_url、api_key、model）
2. **设置提示词**: 在设置中自定义聊天系统提示词（可选）
3. **开始对话**: 
   - 点击"对话"标签页
   - 在输入框中输入消息
   - 点击"发送"按钮或按Enter键

## 特性说明

### 当前支持的功能
✅ 基础的用户-AI对话
✅ 流式响应显示
✅ 复用现有API配置
✅ 可配置的系统提示词
✅ 简洁的消息界面
✅ Enter键快捷发送

### 暂不支持的功能
❌ 对话历史保存
❌ 消息编辑/删除
❌ Markdown渲染
❌ 时间戳显示
❌ Token统计
❌ 清空对话功能

## 测试

使用提供的test.html文件可以测试插件的完整功能：
1. 加载test.html页面
2. 打开插件侧边栏
3. 测试原文提取、翻译和对话功能

## 下一步扩展

后续可以根据需求添加：
- 对话历史管理
- 消息编辑和删除
- Token使用统计
- 导入/导出对话
- 多对话会话管理